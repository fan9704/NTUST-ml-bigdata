# W4 探索性資料分析與資料前處理

---

## 機器（深度）學習工作流程

1. 定義問題
2. 收集數據
3. 數據前處理
4. 選擇與訓練模型
5. 模型預測與評估

## 數據準備階段(Data Preparation)

- 探索性資料分析(EDA, EXploratory Data Analysis)
    - 統計摘要
    - 數據可視化 (針對數值型欄位)
    - 類別分布分析 (針對類別型欄位)
    - 觀察相關矩陣
- 資料前處理（Data Preprocessing）
    - 處理缺失值
    - 特徵縮放 (針對數值型欄位)
    - 特徵編碼 (針對類別型欄位)
- 特徵工程（Feature Engineering）
    - 特徵生成（Feature Generation）
    - 特徵交互（Feature Interaction）
    - 頻率編碼（Frequency Encoding）
    - 特徵轉換（Feature Transformation）

### 探索性資料分析(EDA)

機器學習中對數據初步分析過程，理解數據結構、分布、異常值並識別潛在的數據問題

- 統計摘要
    - df.describe() 查看數值型特徵的統計數據
    - df.info() 確認數據類型及缺失值
- 數據可視化(針對數值欄位)
    - 直方圖 px.histogram() 顯示數值型特徵的分布
    - 箱型圖 px.box() 檢查數據的異常值與分布
    - 散點圖 px.scatter() 觀察兩個變數之間的關係
- 類別分布分析(針對類別型欄位)
    - 計算類別頻率 df["column"].value_counts() 了解不同類別出現的頻率
    - 長條圖 px.bar() 視覺化類別數據的分布
    - 分組箱型圖 px.box() 觀察類別變數對數值變數的影響


### 觀察相關矩陣

- 識別高相關性變數：如果兩個變數的相關係數 接近 1 或 -1，表示它們具有很強的線性關係，可能可以合併或刪除其中一個變數
- 發現多重共線性：如果多個變數之間高度相關，可能會導致機器學習模型的係數不穩定（特別是在回歸模型中）
- 特徵選擇：可以幫助我們選擇影響較大的變數，減少冗餘特徵，提高模型效能

---

## 資料前處理(Data Preprocessing)

### 處理缺失值

```python
df['Age'].fillna(df['Age'].mean(), inplace=True) # 用平均數填補缺失值
df['Embarked'].fillna(df['Embarked'].mode()[0], inplace=True) # 用最常出現值填補
```

### 特徵縮放（Feature Scaling）

- 在機器學習中，數值特徵的範圍可能相差甚遠，這可能會影響模型的表現，因此我們通常會對特徵進行縮放
- 示例：年齡（1~100） vs. 收入（$20,000~$100,000）
    - 直接輸入可能會讓模型更關注「收入」而非「年齡
    - 透過特徵縮放，使這兩者在相同範圍內（如 0~1），減少偏差
- 主要縮放方法
    - Min-Max Scaling（最小-最大縮放）
    - Standard Scaling（標準化縮放）


#### 最小-最大縮放（Min-Max Scaling）

- 適合數據:  非常態分佈
- 將數據縮放到 [0, 1] 的範圍內

![Min Max Scaling](w4/minmax-scaling.png)

```python
from sklearn.preprocessing import MinMaxScaler

scaler = MinMaxScaler()
df['Fare_minmax'] = scaler.fit_transform(df[['Fare']])

# 適用場景：數據有固定範圍時，例如像像素值 (0-255)
```


#### 標準化縮放（Standard Scaling ）

- 適合數據:  常態分佈
- 將數據轉換為均值為 0，標準差為 1

![Standard Scaling](w4/standard-scaling.png)

```python
from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()
df['Fare_standardized'] = scaler.fit_transform(df[['Fare']])

# 適用場景： 當數據分佈接近常態分佈時，標準化效果更好
```

### 特徵編碼（Feature Encoding）

- 機器學習只能處理數值數據，因此類別數據（Categorical Data） 必須轉換為數字格式
- One-Hot Encoding（獨熱編碼）
- Label Encoding（標籤編碼）
